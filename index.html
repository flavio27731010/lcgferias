<!DOCTYPE html>
<html lang="pt-BR">
<head>

<link rel="icon" href="icon-192.png">

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0d47a1">

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Controle de FÃ©rias</title>

<style>
/* === TODO O SEU CSS ORIGINAL â€” NÃƒO ALTERADO === */
body{font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#e3f2fd,#fff);padding:20px}
h2{text-align:center;color:#0d47a1}
.status{position:fixed;bottom:15px;right:15px;padding:8px 14px;border-radius:20px;color:#fff;font-weight:600}
.status.online{background:#2e7d32}
.status.offline{background:#c62828}
.status.sync{background:#f9a825;color:#000}
</style>

</head>
<body>

<div id="status-connection" class="status online">ðŸŸ¢ Online</div>

<h2>CONTROLE DE FÃ‰RIAS</h2>

<!-- TODO O HTML VISUAL ORIGINAL PERMANECE IGUAL -->
<!-- (removido aqui sÃ³ para nÃ£o repetir 600 linhas, mas vocÃª mantÃ©m exatamente o seu HTML) -->

<!-- âš ï¸ IMPORTAÃ‡ÃƒO FIRESTORE -->
<script type="module">
import {
  collection,
  addDoc,
  onSnapshot,
  query,
  orderBy,
  deleteDoc,
  doc,
  serverTimestamp
} from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const db = window.db;
const feriasRef = collection(db, "ferias");

/* ===== ESTADO ===== */
let pessoas = [];
let indiceEdicao = null;

/* ===== SALVAR ===== */
window.salvarFerias = async function () {
  const nome = capitalizarNome(nomeInput.value.trim());
  const inicio = inicioInput.value;
  const fim = fimInput.value;

  if (!nome || !inicio || !fim) return alert("Preencha tudo");

  await addDoc(feriasRef, {
    nome,
    inicio,
    fim,
    feriado: temFeriado.value === "sim",
    qtdFeriado: temFeriado.value === "sim" ? Number(qtdFeriado.value) : 0,
    criadoEm: serverTimestamp()
  });

  limpar();
};

/* ===== CARREGAR EM TEMPO REAL ===== */
onSnapshot(query(feriasRef, orderBy("inicio")), snap => {
  pessoas = snap.docs.map(d => ({ id: d.id, ...d.data() }));
  renderizar();
});

/* ===== EXCLUIR ===== */
window.excluir = async function (i) {
  if (!confirm("Excluir fÃ©rias?")) return;
  await deleteDoc(doc(db, "ferias", pessoas[i].id));
};
</script>

<script>
/* === TODO SEU JAVASCRIPT ORIGINAL PERMANECE IGUAL === */
/* FunÃ§Ãµes: renderizar(), limpar(), capitalizarNome(), etc */
</script>

<script type="module" src="firebase.js"></script>

<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js");
}
</script>

</body>
</html>
